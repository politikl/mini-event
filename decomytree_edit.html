<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Edit Tree - DecomyTree</title>
    <link rel="stylesheet" href="decomytree.css">
    <link rel="stylesheet" href="decomytree_view.css">
</head>
<body>
    <div class="background-trees"></div>
    <div class="celestial-body sun"></div>
    
    <!-- Menu Background Selector -->
    <div id="menu-bg-container" class="menu-bg-container">
        <label for="menu-bg-select" style="color:rgba(245,240,232,0.7);font-size:0.85em;margin-right:8px;display:flex;align-items:center;height:32px">Background:</label>
        <select id="menu-bg-select" style="padding:6px;border-radius:4px;border:1px solid rgba(212,175,55,0.3);background:rgba(51,51,51,0.8);color:var(--cream);cursor:pointer;font-size:0.85em;height:32px">
            <option value="scene-default">Classic</option>
            <option value="scene-colorful">Colorful</option>
            <option value="scene-snowy">Snowy</option>
            <option value="scene-aurora">Aurora</option>
            <option value="scene-sunset">Sunset</option>
            <option value="scene-midnight">Midnight</option>
            <option value="scene-forest">Forest</option>
            <option value="scene-cosmic">Cosmic</option>
        </select>
    </div>
    
    <div id="auth-container">
        <div id="user-info" class="hidden">
            <span id="username-display"></span>
            <button id="sign-out-btn">Sign Out</button>
        </div>
    </div>

    <main class="container">
        <div class="view-header">
            <button id="back-btn" class="back-btn">â† Back</button>
            <h1>Edit Your Tree</h1>
        </div>

        <div class="edit-panel panel">
            <label>Tree Color:</label>
            <div class="designs">
                <label><input type="radio" name="color" value="green"> <span>ğŸŸ¢ Green</span></label>
                <label><input type="radio" name="color" value="blue"> <span>ğŸ”µ Blue</span></label>
                <label><input type="radio" name="color" value="frost"> <span>â„ï¸ Frost</span></label>
                <label><input type="radio" name="color" value="emerald"> <span>ğŸ’š Emerald</span></label>
                <label><input type="radio" name="color" value="midnight"> <span>ğŸŒŒ Midnight</span></label>
                <label><input type="radio" name="color" value="forest"> <span>ğŸŒ² Forest</span></label>
                <label><input type="radio" name="color" value="gold"> <span>âœ¨ Gold</span></label>
                <label><input type="radio" name="color" value="silver"> <span>ğŸ’ Silver</span></label>
                <label><input type="radio" name="color" value="purple"> <span>ğŸ’œ Purple</span></label>
                <label><input type="radio" name="color" value="ruby"> <span>â¤ï¸ Ruby</span></label>
                <label><input type="radio" name="color" value="copper"> <span>ğŸŒ° Copper</span></label>
                <label><input type="radio" name="color" value="jade"> <span>ğŸŸ¢ Jade</span></label>
                <label><input type="radio" name="color" value="rose"> <span>ğŸŒ¹ Rose</span></label>
                <label><input type="radio" name="color" value="bronze"> <span>ğŸª™ Bronze</span></label>
                <label><input type="radio" name="color" value="pearl"> <span>âšª Pearl</span></label>
            </div>

            <label style="margin-top:12px">Top Star Style:</label>
            <div class="designs">
                <label><input type="radio" name="star" value="star"> <span>â­ Star</span></label>
                <label><input type="radio" name="star" value="gold-star"> <span>ğŸŒŸ Gold</span></label>
                <label><input type="radio" name="star" value="angel"> <span>ğŸ‘¼ Angel</span></label>
                <label><input type="radio" name="star" value="snowflake"> <span>â„ï¸ Snowflake</span></label>
                <label><input type="radio" name="star" value="sparkle"> <span>âœ¨ Sparkle</span></label>
                <label><input type="radio" name="star" value="bow"> <span>ğŸ€ Bow</span></label>
                <label><input type="radio" name="star" value="crown"> <span>ğŸ‘‘ Crown</span></label>
                <label><input type="radio" name="star" value="ornament"> <span>ğŸ”´ Ornament</span></label>
                <label><input type="radio" name="star" value="flame"> <span>ğŸ”¥ Flame</span></label>
            </div>

            <label style="margin-top:12px">Scene Theme:</label>
            <div class="designs">
                <label><input type="radio" name="theme" value="scene-default"> <span>Classic</span></label>
                <label><input type="radio" name="theme" value="scene-colorful"> <span>Colorful</span></label>
                <label><input type="radio" name="theme" value="scene-snowy"> <span>Snowy</span></label>
                <label><input type="radio" name="theme" value="scene-aurora"> <span>Aurora</span></label>
                <label><input type="radio" name="theme" value="scene-sunset"> <span>Sunset</span></label>
                <label><input type="radio" name="theme" value="scene-midnight"> <span>Midnight</span></label>
                <label><input type="radio" name="theme" value="scene-forest"> <span>Forest</span></label>
                <label><input type="radio" name="theme" value="scene-cosmic"> <span>Cosmic</span></label>
            </div>

            <label style="margin-top:16px"><input type="checkbox" id="tree-public"> Make this tree <strong>public</strong></label>

            <div class="modal-buttons" style="margin-top:20px">
                <button id="save-tree-btn" class="primary">Save Changes</button>
                <button id="share-tree-btn" class="primary" style="margin-left:8px">ğŸ”— Share Tree</button>
                <button id="back-to-view" class="cancel">Cancel</button>
            </div>
        </div>
    </main>

    <!-- Share Tree Modal -->
    <div id="share-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Share Your Tree</h2>
            <p>Add friends to your private tree by their username.</p>
            
            <div style="position:relative">
                <label>Friend's Username:
                    <input type="text" id="share-email" placeholder="First L" style="width:100%;padding:8px;margin:8px 0;border-radius:6px;border:1px solid rgba(212,175,55,0.3);background:rgba(255,255,255,0.05);color:var(--cream)">
                </label>
                <div id="share-suggestions" style="position:absolute;top:100%;left:0;right:0;background:rgba(13,94,63,0.8);border:1px solid rgba(212,175,55,0.3);border-radius:6px;max-height:150px;overflow-y:auto;z-index:100;display:none;margin-top:-4px"></div>
            </div>

            <div id="invited-users" style="margin-top:16px">
                <h3 style="color:var(--gold);margin-bottom:8px">Invited Users:</h3>
                <div id="invited-list" style="max-height:200px;overflow-y:auto"></div>
            </div>

            <div class="modal-buttons" style="margin-top:20px">
                <button id="add-user-btn" class="primary">Add User</button>
                <button id="close-share-btn" class="cancel">Close</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-analytics.js";
        import { 
            getAuth, 
            GoogleAuthProvider, 
            signInWithPopup, 
            signOut, 
            onAuthStateChanged 
        } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-auth.js";
        import { 
            getFirestore, 
            doc, 
            setDoc, 
            getDoc, 
            updateDoc,
            serverTimestamp,
            arrayUnion,
            arrayRemove,
            collection,
            query,
            where,
            getDocs
        } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyARY96nrH2Aio8rOiLkewSXtTS40TZLrAw",
            authDomain: "nerd-mini-events.firebaseapp.com",
            projectId: "nerd-mini-events",
            storageBucket: "nerd-mini-events.firebasestorage.app",
            messagingSenderId: "974357416633",
            appId: "1:974357416633:web:e190de60553d03e968",
            measurementId: "G-V9NGCSEY8J"
        };

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const db = getFirestore(app);

        window.firebaseAuth = auth;
        window.firebaseDb = db;
        window.firebaseSignOut = signOut;
        window.firebaseOnAuthStateChanged = onAuthStateChanged;
        window.firebaseDoc = doc;
        window.firebaseGetDoc = getDoc;
        window.firebaseUpdateDoc = updateDoc;
        window.firebaseServerTimestamp = serverTimestamp;
        window.firebaseArrayUnion = arrayUnion;
        window.firebaseArrayRemove = arrayRemove;
        window.firebaseCollection = collection;
        window.firebaseQuery = query;
        window.firebaseWhere = where;
        window.firebaseGetDocs = getDocs;

        window.firebaseReady = true;
        if (window.initEditTree) window.initEditTree();
    </script>

    <script src="decomytree_edit.js"></script>
</body>
</html>
