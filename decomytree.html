<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Deco My Tree</title>
    <link rel="stylesheet" href="decomytree.css">
    <link rel="icon" type="image/png" href="christmas-tree.png">
</head>
<body>
    <div class="background-trees"></div>
    <div class="celestial-body sun"></div>
    
    <!-- Menu Background Selector -->
    <div id="menu-bg-container" class="menu-bg-container">
        <label for="menu-bg-select" style="color:rgba(245,240,232,0.7);font-size:0.85em;margin-right:8px;display:flex;align-items:center;height:32px">Background:</label>
        <select id="menu-bg-select" style="padding:6px;border-radius:4px;border:1px solid rgba(212,175,55,0.3);background:rgba(51,51,51,0.8);color:var(--cream);cursor:pointer;font-size:0.85em;height:32px">
            <option value="scene-default">Classic</option>
            <option value="scene-colorful">Colorful</option>
            <option value="scene-snowy">Snowy</option>
            <option value="scene-aurora">Aurora</option>
            <option value="scene-sunset">Sunset</option>
            <option value="scene-midnight">Midnight</option>
            <option value="scene-forest">Forest</option>
            <option value="scene-cosmic">Cosmic</option>
        </select>
    </div>
    <div id="auth-container">
        <div id="user-info" class="hidden">
            <span id="username-display"></span>
            <button id="sign-out-btn">Sign Out</button>
        </div>
        <button id="sign-in-btn" class="hidden">Sign In with Google</button>
    </div>

    <main class="container">
        <h1>Deco My Tree</h1>
        <div id="main-area">
            <div id="no-tree" class="panel hidden">
                <p>You don't have a tree yet.</p>
                <button id="create-tree-btn" class="primary">Create Your Tree</button>
            </div>

            <div id="has-tree" class="panel hidden">
                <p>Welcome back! âœ¨</p>
                <button id="view-tree-btn" class="primary">View Your Tree</button>
                <button id="edit-tree-btn" style="margin-left:8px">Edit Tree</button>
                <button id="add-ornament-btn" style="margin-left:8px">Add Ornament to Other Trees</button>
            </div>
        </div>
    </main>

    <!-- Create Tree Modal -->
    <div id="create-tree-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Customize Your Tree</h2>
            <p style="font-size:0.95em;margin-bottom:16px">Choose your tree design and color</p>
            
            <label>Tree Color:</label>
            <div class="designs">
                <label><input type="radio" name="color" value="green" checked> <span>ğŸŸ¢ Green</span></label>
                <label><input type="radio" name="color" value="blue"> <span>ğŸ”µ Blue</span></label>
                <label><input type="radio" name="color" value="frost"> <span>â„ï¸ Frost</span></label>
                <label><input type="radio" name="color" value="emerald"> <span>ğŸ’š Emerald</span></label>
                <label><input type="radio" name="color" value="midnight"> <span>ğŸŒŒ Midnight</span></label>
                <label><input type="radio" name="color" value="forest"> <span>ğŸŒ² Forest</span></label>
                <label><input type="radio" name="color" value="gold"> <span>âœ¨ Gold</span></label>
                <label><input type="radio" name="color" value="silver"> <span>ğŸ’ Silver</span></label>
                <label><input type="radio" name="color" value="purple"> <span>ğŸ’œ Purple</span></label>
                <label><input type="radio" name="color" value="ruby"> <span>â¤ï¸ Ruby</span></label>
                <label><input type="radio" name="color" value="copper"> <span>ğŸŒ° Copper</span></label>
                <label><input type="radio" name="color" value="jade"> <span>ğŸŸ¢ Jade</span></label>
                <label><input type="radio" name="color" value="rose"> <span>ğŸŒ¹ Rose</span></label>
                <label><input type="radio" name="color" value="bronze"> <span>ğŸª™ Bronze</span></label>
                <label><input type="radio" name="color" value="pearl"> <span>âšª Pearl</span></label>
            </div>

            <label>Top Star Style:</label>
            <div class="designs">
                <label><input type="radio" name="star" value="star" checked> <span>â­ Star</span></label>
                <label><input type="radio" name="star" value="gold-star"> <span>ğŸŒŸ Gold</span></label>
                <label><input type="radio" name="star" value="angel"> <span>ğŸ‘¼ Angel</span></label>
                <label><input type="radio" name="star" value="snowflake"> <span>â„ï¸ Snowflake</span></label>
                <label><input type="radio" name="star" value="sparkle"> <span>âœ¨ Sparkle</span></label>
                <label><input type="radio" name="star" value="bow"> <span>ğŸ€ Bow</span></label>
                <label><input type="radio" name="star" value="crown"> <span>ğŸ‘‘ Crown</span></label>
                <label><input type="radio" name="star" value="ornament"> <span>ğŸ”´ Ornament</span></label>
                <label><input type="radio" name="star" value="flame"> <span>ğŸ”¥ Flame</span></label>
            </div>

            <label style="margin-top:12px">Scene Theme:</label>
            <div class="designs">
                <label><input type="radio" name="theme" value="scene-default" checked> <span>Classic</span></label>
                <label><input type="radio" name="theme" value="scene-colorful"> <span>Colorful</span></label>
                <label><input type="radio" name="theme" value="scene-snowy"> <span>Snowy</span></label>
                <label><input type="radio" name="theme" value="scene-aurora"> <span>Aurora</span></label>
                <label><input type="radio" name="theme" value="scene-sunset"> <span>Sunset</span></label>
                <label><input type="radio" name="theme" value="scene-midnight"> <span>Midnight</span></label>
                <label><input type="radio" name="theme" value="scene-forest"> <span>Forest</span></label>
                <label><input type="radio" name="theme" value="scene-cosmic"> <span>Cosmic</span></label>
            </div>

            <label style="margin-top:16px"><input type="checkbox" id="tree-public" checked> Make this tree <strong>public</strong> (searchable by all)</label>
            
            <div class="modal-buttons">
                <button id="publish-tree-btn" class="primary">Create My Tree</button>
                <button id="cancel-create-tree" class="cancel">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Force Sign-In Modal (must sign in) -->
    <div id="force-signin-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Sign in required</h2>
            <p>You must sign in with your `@lakesideschool.org` account to use Deco My Tree.</p>
            <button id="force-signin-btn" class="primary">Sign In with Google</button>
        </div>
    </div>

    <!-- Firebase SDK and initialization (reuse project config) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-analytics.js";
        import { 
            getAuth, 
            GoogleAuthProvider, 
            signInWithPopup, 
            signOut, 
            onAuthStateChanged 
        } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-auth.js";
        import { 
            getFirestore, 
            doc, 
            setDoc, 
            getDoc, 
            collection, 
            getDocs, 
            query, 
            where, 
            orderBy, 
            limit, 
            serverTimestamp
        } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyARY96nrH2Aio8rOiLkewSXtTS40TZLrAw",
            authDomain: "nerd-mini-events.firebaseapp.com",
            projectId: "nerd-mini-events",
            storageBucket: "nerd-mini-events.firebasestorage.app",
            messagingSenderId: "974357416633",
            appId: "1:974357416633:web:e190de605d03e968",
            measurementId: "G-V9NGCSEY8J"
        };

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const provider = new GoogleAuthProvider();

        // expose to page script
        window.firebaseApp = app;
        window.firebaseAuth = auth;
        window.firebaseDb = db;
        window.googleProvider = provider;
        window.firebaseSignInWithPopup = signInWithPopup;
        window.firebaseSignOut = signOut;
        window.firebaseOnAuthStateChanged = onAuthStateChanged;
        window.firebaseDoc = doc;
        window.firebaseSetDoc = setDoc;
        window.firebaseGetDoc = getDoc;
        window.firebaseCollection = collection;
        window.firebaseGetDocs = getDocs;
        window.firebaseQuery = query;
        window.firebaseWhere = where;
        window.firebaseOrderBy = orderBy;
        window.firebaseLimit = limit;
        window.firebaseServerTimestamp = serverTimestamp;

        window.firebaseReady = true;
        if (window.initDecomyTree) window.initDecomyTree();
    </script>

    <script src="decomytree.js"></script>
</body>
</html>
